<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Pod::Advent 0.09 (Pod::Simple 3.04, Perl::Tidy 20070508) on 2008-12-06 15:50:16 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>2008 Perl Advent Calendar: Baby it's cold outside, so why don't we tuck into a curry?</title>
<link rel="stylesheet" href="../style.css" type="text/css" />
<link rel="alternate" type="text/plain" href="6.pod" />
</head>
<body>
<h1><a href="../">Perl Advent Calendar 2008-12</a>-06</h1>
<h2 align="center">Baby it's cold outside, so why don't we tuck into a curry?</h2>
<h3 align="center">by David Westbrook</h3>
<p>It's the time of the year for caroling, and that means everyone's favorite <span style="font-weight: bold">The Twelve Days of Christmas</span>. Being a <tt><a href="http://en.wikipedia.org/wiki/Cumulative_song">cumulative song</a></tt>, we'd like a shortcut for constructing each verse, which boils down to a function (lines 3-8) that simply generates the form:</p>
<pre><span class="c">On the ? day of Christmas my true love gave to me
        ...,
        and a partridge in a pear tree.</span></pre>
<p><tt><a href="http://search.cpan.org/search?module=Sub::Curry">Sub::Curry</a></tt> will allow us to call that function for the current verse (line 12), and then create a new function (line 13), which includes the prose to date, to use for the next verse.</p>
<p>The <tt><span class="w">HOLE</span>
</tt> and <tt><span class="w">BLACKHOLE</span>
</tt> <tt><a href="http://search.cpan.org/perldoc?Sub::Curry#Currying">curry-constants</a></tt> create a way to prepend our arguments to generate the correct order; alternatively<sup><a href="#footnote1">1</a></sup> we could <tt><span class="i">curry</span><span class="s">(</span><span class="i">$fn</span><span class="cm">,</span><span class="i">$lyric</span><span class="s">)</span>
</tt> and have <tt><span class="i">$fn</span>
</tt> just <tt><span class="k">reverse</span> <span class="i">@_</span>
</tt>, but this way spices things up! Other tasty recipes can be found in the would actually be better for <tt><a href="http://search.cpan.org/perldoc?Sub::Curry::Cookbook">Sub::Curry::Cookbook</a></tt>.</p>
<p>So, putting everything together, we can <s>eat</s> sing along with the last verse as generated:</p>
<pre><span class="c">On the twelfth day of Christmas my true love gave to me
        twelve drummers drumming,
        eleven pipers piping,
           ten lords a-leaping,
          nine ladies dacing,
         eight maids a-milking,
         seven swans a-swimming,
           six geese a-laying,
          five golden rings,
          four calling birds,
         three french hens,
           two turtle doves,
        and a partridge in a pear tree.</span></pre>
<a name="mod6.pl" id="mod6.pl"></a><h2><a href="mod6.pl">mod6.pl</a></h2><pre>
   1 <span class="k">use</span> <span class="w">Sub::Curry</span> <span class="q">qw/ :CONST curry /</span><span class="sc">;</span>
   2 
   3 <span class="k">my</span> <span class="i">$fn</span> = <span class="k">sub</span> <span class="s">{</span>
   4   <span class="k">my</span> <span class="i">@lines</span> = <span class="k">map</span> <span class="s">{</span> <span class="q">&quot;\t&quot;</span> . <span class="i">$_</span> <span class="s">}</span> <span class="i">@_</span><span class="sc">;</span>
   5   <span class="k">my</span> <span class="i">@nums</span> = <span class="q">qw/ first second third fourth fifth sixth seventh eighth nineth tenth eleventh twelfth /</span><span class="sc">;</span>
   6   <span class="i">$lines</span>[<span class="n">-1</span>] =~ <span class="q">s/\t\s*/\tand /</span> <span class="k">if</span> <span class="i">@lines</span> &gt; <span class="n">1</span><span class="sc">;</span> <span class="c"># grammatical hack</span>
   7   <span class="k">print</span> <span class="q">&quot;On the &quot;</span> . <span class="i">$nums</span>[<span class="i">$#lines</span>] . <span class="q">&quot; day of Christmas my true love gave to me\n&quot;</span><span class="cm">,</span> <span class="k">join</span><span class="s">(</span><span class="q">&quot;,\n&quot;</span><span class="cm">,</span> <span class="i">@lines</span><span class="s">)</span> . <span class="q">&quot;.\n\n&quot;</span><span class="sc">;</span>
   8 <span class="s">}</span><span class="sc">;</span>
   9 
  10 <span class="k">while</span><span class="s">(</span> <span class="k">my</span> <span class="i">$lyric</span> = <span class="q">&lt;DATA&gt;</span> <span class="s">)</span><span class="s">{</span>
  11   <span class="k">chomp</span><span class="s">(</span><span class="i">$lyric</span><span class="s">)</span><span class="sc">;</span>
  12   <span class="i">$fn</span>-&gt;<span class="s">(</span><span class="i">$lyric</span><span class="s">)</span><span class="sc">;</span>
  13   <span class="i">$fn</span> = <span class="i">curry</span><span class="s">(</span> <span class="i">$fn</span><span class="cm">,</span> <span class="w">HOLE</span><span class="cm">,</span> <span class="w">BLACKHOLE</span><span class="cm">,</span> <span class="i">$lyric</span> <span class="s">)</span><span class="sc">;</span>
  14 <span class="s">}</span><span class="sc">;</span>
  15 
<a name="__DATA__"></a>  16 <span class="k">__DATA__</span>
  17 <span class="q">     a partridge in a pear tree</span>
  18 <span class="q">   two turtle doves</span>
  19 <span class="q"> three french hens</span>
  20 <span class="q">  four calling birds</span>
  21 <span class="q">  five golden rings</span>
  22 <span class="q">   six geese a-laying</span>
  23 <span class="q"> seven swans a-swimming</span>
  24 <span class="q"> eight maids a-milking</span>
  25 <span class="q">  nine ladies dacing</span>
  26 <span class="q">   ten lords a-leaping</span>
  27 <span class="q">eleven pipers piping</span>
  28 <span class="q">twelve drummers drumming</span>
</pre>
<p><a name="footnote1" id="footnote1"></a>1. Of course, simple loop/array solutions work as well; but TMTOWTDI and fun/holiday cheer is as a good reason as any!</p>
<blockquote style="padding: 1em; border: 2px ridge black; background-color:#eee"><p>Our resident discordian editor offers <tt><a href="mod6b.pl">alternative lyrics</a></tt>.</p>
</blockquote>
<div style="float: right; font-size: 10pt"><a href="6.pod">View Source (POD)</a></div><br />
</body>
</html>
